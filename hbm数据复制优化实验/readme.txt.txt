# HBM数据复制优化实验

## 参与人及时间

- 参与人：陈柳青，缪弘博
- 时间：2025-09-10

##代码结构
#sender.py: 发送端主机代码脚本
#receiver.py: 接收端主机代码脚本

##优化
#优化一 减少调用次数，将多个小block拼接成1个大buffer
#优化二 多个通道（多连接）提高带宽利用率
#优化三 动态调整批量大小，根据当前的传输状态动态调整 BATCH_SIZE
#优化四 预分配最大尺寸的缓冲区并复用


##优化代码在CPU端仿真测试
#demo.py
测试数据
✅ 预分配完成：发送/接收缓冲区各 2500.00 MB（最大尺寸）

===== 模拟传输 10000 个 128B 块 | 8个通道 | 当前批次:9000 =====
当前批次耗时: 0.0009 秒
负载正常！批次大小从9000调整为10000

===== 模拟传输 10000 个 256B 块 | 8个通道 | 当前批次:10000 =====
当前批次耗时: 0.0008 秒 
负载正常！批次大小从10000调整为11000

===== 模拟传输 10000 个 512B 块 | 8个通道 | 当前批次:11000 =====
当前批次耗时: 0.0011 秒
负载！批次大小从11000调整为10000

===== 模拟传输 10000 个 1024B 块 | 8个通道 | 当前批次:10000 =====
当前批次耗时: 0.0027 秒 
负载！批次大小从10000调整为9000

===== 模拟传输 10000 个 2048B 块 | 8个通道 | 当前批次:9000 =====
当前批次耗时: 0.0030 秒 
负载！批次大小从9000调整为8000

===== 模拟传输 10000 个 4096B 块 | 8个通道 | 当前批次:8000 =====
当前批次耗时: 0.0056 秒 
负载！批次大小从8000调整为7000

===== 模拟传输 10000 个 8192B 块 | 8个通道 | 当前批次:7000 =====
当前批次耗时: 0.0113 秒 
负载！批次大小从7000调整为6000

===== 模拟传输 10000 个 16384B 块 | 8个通道 | 当前批次:6000 =====
当前批次耗时: 0.0206 秒 
负载！批次大小从6000调整为5000

===== 模拟传输 10000 个 32768B 块 | 8个通道 | 当前批次:5000 =====
当前批次耗时: 0.0438 秒 
负载！批次大小从5000调整为4000

===== 模拟传输 10000 个 65536B 块 | 8个通道 | 当前批次:4000 =====
当前批次耗时: 0.0896 秒 
负载！批次大小从4000调整为3000

===== 模拟传输 10000 个 131072B 块 | 8个通道 | 当前批次:3000 =====
当前批次耗时: 0.1658 秒 
负载！批次大小从3000调整为2000

===== 模拟传输 10000 个 262144B 块 | 8个通道 | 当前批次:2000 =====
当前批次耗时: 0.3519 秒 
负载！批次大小从2000调整为1000
